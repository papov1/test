/* v 3.6
author http://codecanyon.net/user/creativeinteractivemedia/portfolio?ref=creativeinteractivemedia
*/

var FLIPBOOK=FLIPBOOK||{};FLIPBOOK.BookSwipe=function(e,i,s,t){this.options=t,this.singlePage=t.singlePageMode,this.pageWidth=this.options.pageWidth,this.pageHeight=this.options.pageHeight,this.slides=[],this.pagesArr=[],this.leftPage=0,this.rightPage=0,this.prevPageEnabled=!1,this.setRightIndex(t.rightToLeft?t.pages.length:0),this.currentSlide=0,this.flipping=!1,this.wrapper=i,this.$wrapper=jQuery(i),this.scroller=e,this.$scroller=jQuery(this.scroller).removeClass("book").addClass("flipbook-carousel-scroller"),this.iscroll=new IScroll(this.wrapper,{snap:!0,snapSpeed:200*this.options.pageFlipDuration,freeScroll:!0,scrollX:!0,scrollY:!1,preventDefault:!1,disableTouch:!0,eventPassthrough:"vertical"});for(var o=0;o<3;o++){var n=jQuery('<div class="flipbook-carousel-slide"><div class="slide-inner"/></div>"').appendTo(this.$scroller);this.slides.push(n)}this.slides[0].iscroll=new IScroll(this.slides[0][0],{zoom:!0,scrollX:!0,scrollY:!0,freeScroll:!0,keepInCenterV:!0,keepInCenterH:!0,preventDefault:!1}),this.slides[2].iscroll=new IScroll(this.slides[2][0],{zoom:!0,scrollX:!0,scrollY:!0,freeScroll:!0,keepInCenterV:!0,keepInCenterH:!0,preventDefault:!1}),this.slides[1].iscroll=new IScroll(this.slides[1][0],{zoom:!0,scrollX:!0,scrollY:!0,freeScroll:!0,keepInCenterV:!0,keepInCenterH:!0,preventDefault:!1});for(o=0;o<3;o++)this.slides[o].iscroll.on("zoomEnd",function(){var e=t.main.zoom;this.options.eventPassthrough=1<e?"":"vertical",this.options.freeScroll=1<e,this.refresh()});var l;this.slides[1].iscroll.on("zoomStart",function(){}),this.resizeInnerSlides();for(t.rightToLeft,t.numPages,t.pdfMode,o=0;o<t.numPages;o++)l=new FLIPBOOK.PageSwipe(t,o,t.pages[o].src,t.pages[o].htmlContent),this.pagesArr.push(l),t.loadAllPages&&l.load();var h=this;this.iscroll.on("scrollStart",function(){h.disablePan()}),this.iscroll.on("scrollEnd",function(){h.enablePan();var e=this.currentPage.pageX;h.singlePage?e>h.currentSlide?h.setRightIndex(h.rightIndex+1):e<h.currentSlide&&h.setRightIndex(h.rightIndex-1):e>h.currentSlide?h.setRightIndex(h.rightIndex+2):e<h.currentSlide&&h.setRightIndex(h.rightIndex-2),h.currentSlide=e,h.updateVisiblePages(),h.flipping=!1}),this.flipEnabled=!0,this.nextEnabled=!0,this.prevEnabled=!0,s.on("toolMove",function(){h.updateTool()}),s.on("toolSelect",function(){h.updateTool()})},FLIPBOOK.BookSwipe.prototype.constructor=FLIPBOOK.BookSwipe,FLIPBOOK.BookSwipe.prototype={goToPage:function(e,i){if(this.enabled&&this.flipEnabled){if((this.singlePage||e%2!=0)&&e--,(isNaN(e)||e<0)&&(e=0),e>this.options.pages.length&&(e=this.options.pages.length),this.resetZoom(),i)return this.setRightIndex(e),void this.updateVisiblePages();this.singlePage?(this.options.rightToLeft&&this.options.oddPages&&e<1&&(e=1),e>this.rightIndex?(this.setSlidePages(this.currentSlide+1,[e]),this.setRightIndex(e-1),this.nextPage(i)):e<this.rightIndex&&(this.setSlidePages(this.currentSlide-1,[e]),this.setRightIndex(e+1),this.prevPage(i))):(this.options.rightToLeft&&this.options.oddPages&&e<2&&(e=2),e>this.rightIndex?e>=this.pagesArr.length?(this.setSlidePages(2,[e-1,e]),this.setRightIndex(e-2),this.goToSlide(2,i)):(this.setSlidePages(this.currentSlide+1,[e-1,e]),this.setRightIndex(e-2),this.nextPage(i)):e<this.rightIndex&&(0==e?(this.setRightIndex(e+2),this.setSlidePages(0,[e]),this.goToSlide(0,i)):(this.setRightIndex(e+2),this.setSlidePages(this.currentSlide-1,[e-1,e]),this.prevPage(i))))}},setRightIndex:function(e){this.rightIndex=e},nextPage:function(e){this.flipEnabled&&2!=this.currentSlide&&(this.flipping=!0,this.goToSlide(this.currentSlide+1,e))},prevPage:function(e){this.flipEnabled&&0!=this.currentSlide&&(this.flipping=!0,this.goToSlide(this.currentSlide-1,e))},enablePrev:function(e){this.prevEnabled=e},enableNext:function(e){this.nextEnabled=e},resetZoom:function(){},setSlidePages:function(e,i){for(var s=[],t=0;t<i.length;t++)s.push(i[t].index);if(!this.slides[e].pages||s.join("")!==this.slides[e].pages.join("")){this.clearSlidePages(e);var o=this.slides[e].find(".slide-inner");for(t=0;t<i.length;t++){var n=i[t].index;this.pagesArr[n]&&(o.append(this.pagesArr[n].$wrapper),this.slides[e].pages.push(n))}this.resizeInnerSlides(),this.slides[e].iscroll&&this.slides[e].iscroll.refresh()}},updateTool:function(){switch(this.options.main.tool){case"toolSelect":this.disableFlip(),this.disablePan(),jQuery(".flipbook-textLayer").css("pointer-events","auto").removeClass(".flipbook-noselect");break;case"toolMove":this.onZoom(this.options.main.zoom),jQuery(".flipbook-textLayer").css("pointer-events","none").addClass(".flipbook-noselect")}},clearSlidePages:function(e){this.slides[e].find(".slide-inner").empty(),this.slides[e].pages=[]},setZoomPages:function(e){if(!this.$zoomScroller.pages||this.$zoomScroller.pages.join("")!=e.join("")){this.$zoomScroller.empty(),this.$zoomScroller.pages=[];for(var i=0;i<e.length;i++){var s=e[i];this.pagesArr[s]&&(this.$zoomScroller.append(this.pagesArr[s].$wrapper),this.$zoomScroller.pages.push(s))}}},resizeZoomPages:function(e,i){var s=this.$wrapper.height()*i,t=500*parseInt(s/500)+500;t<500&&(t=500),2e3<t&&(t=2e3);for(var o=0;o<e.length;o++){var n=e[o];this.pagesArr[n]&&this.pagesArr[n].load()}},getCurrentSlidePages:function(){return this.singlePage?[this.rightIndex]:[this.rightIndex-1,this.rightIndex]},clearSlide:function(e){this.slides[e].empty()},hasPage:function(e,i){},updateVisiblePages:function(){var e=this.options.main,i=this.rightIndex;this.options.rightToLeft&&this.options.oddPages&&i--;var s=this.pagesArr[i],t=this.pagesArr[i-1],o=this.pagesArr[i+1],n=this.pagesArr[i+2],l=this.pagesArr[i-2],h=this.pagesArr[i-3];this.singlePage?(t?o?(this.setSlidePages(1,[s]),this.setSlidePages(0,[t]),this.setSlidePages(2,[o]),this.goToSlide(1,!0)):(this.setSlidePages(2,[s]),this.setSlidePages(1,[t]),this.goToSlide(2,!0),this.clearSlidePages(0)):(this.setSlidePages(0,[s]),this.setSlidePages(1,[o]),this.goToSlide(0,!0),this.clearSlidePages(2)),s.load(function(){e.setLoadingProgress(1),t&&t.load(),o&&o.load()})):(t?s?o?(l&&(this.setSlidePages(1,[t,s]),h?this.setSlidePages(0,[h,l]):this.setSlidePages(0,[l]),this.goToSlide(1,!0)),n?this.setSlidePages(2,[o,n]):this.setSlidePages(2,[o])):(this.setSlidePages(2,[t,s]),h?this.setSlidePages(1,[h,l]):this.setSlidePages(1,[l]),this.clearSlidePages(0)):(this.setSlidePages(2,[t]),h?this.setSlidePages(1,[h,l]):this.setSlidePages(1,[l]),this.goToSlide(2,!0),this.clearSlidePages(0)):(this.setSlidePages(0,[s]),n?this.setSlidePages(1,[o,n]):this.setSlidePages(1,[o]),this.goToSlide(0,!0),this.clearSlidePages(2)),t?t.load(function(){s?s.load(function(){e.setLoadingProgress(1),l&&l.load(),h&&h.load(),o&&o.load(),n&&n.load()}):(e.setLoadingProgress(1),l&&l.load(),h&&h.load())}):s&&s.load(function(){e.setLoadingProgress(1),o&&o.load(),n&&n.load()})),this.options.main.turnPageComplete()},loadPage:function(e){this.pagesArr[e]&&this.pagesArr[e].load()},hidePage:function(e){},showPage:function(e){},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0,this.onResize()},resize:function(){},onResize:function(){var e=this.$wrapper.width(),i=this.$wrapper.height();if(this.w=e,this.h=i,0!=e&&0!=i){var s,t=this.pageWidth,o=this.pageHeight,n=2*this.options.zoomMin*t/o>e/i,l=!this.options.singlePageMode&&(!this.options.responsiveView||e>this.options.responsiveViewTreshold||!n),h=l?2*t:t,a=o;this.bw=h,s=(this.bh=a)/h<i/e?a/h*e/this.options.pageTextureSize:i/this.options.pageTextureSize;for(var r=0;r<this.slides.length;r++)this.slides[r].width(e+0).height(i),this.slides[r].iscroll&&(this.slides[r].iscroll.options.zoomMin=this.options.zoomMin*s,this.slides[r].iscroll.options.zoomMax=this.options.zoomMax*s,this.slides[r].iscroll.refresh());this.$scroller.width(this.$scroller.children().length*(e+0)),this.iscroll.refresh(),l&&!this.options.singlePageMode||this.singlePage?l&&!this.options.singlePageMode&&this.singlePage&&(this.rightIndex%2!=0&&this.setRightIndex(this.rightIndex+1),this.singlePage=!1,this.resizeInnerSlides()):(this.rightIndex%2==0&&0<this.rightIndex&&this.setRightIndex(this.rightIndex-1),this.singlePage=!0,this.resizeInnerSlides()),this.updateVisiblePages()}},resizeInnerSlides:function(){for(var e=this.options.pageTextureSize*this.pageWidth/this.pageHeight,i=this.singlePage?e:2*e,s=0;s<3;s++)i=this.slides[s].pages&&1==this.slides[s].pages.length?e:2*e,this.slides[s].find(".slide-inner").width(i)},resizeInnerSlide:function(e){var i=this.options.pageTextureSize*this.pageWidth/this.pageHeight;this.slides[e].pages.length,this.slides[e].find(".slide-inner").width(i)},goToSlide:function(e,i){var s=i?0:300*this.options.pageFlipDuration;0<this.iscroll.pages.length&&this.iscroll.goToPage(e,0,s),i&&(this.currentSlide=e),this.zoomTo(this.options.zoomMin)},getCurrentSlide:function(){return this.currentSlide},zoomIn:function(e,i,s){s&&"mousewheel"===s.type||this.zoomTo(e)},zoomTo:function(e,i,s,t){if(this.enabled){s=s||0,t=t||0,i=i||0;if(1<e&&this.disableFlip(),0!=n&&0!=l){var o,n=this.w,l=this.h,h=(this.pageWidth,this.pageHeight,this.bw),a=this.bh;o=a/h<l/n?a/h*e*n/this.options.pageTextureSize:e*l/this.options.pageTextureSize;for(var r=0;r<3;r++)this.slides[r].iscroll&&this.slides[r].iscroll.zoom(o,s,t,i);this.onZoom(e)}}},zoomOut:function(e){this.zoomTo(e)},onZoom:function(e){"toolSelect"==this.options.main.tool?(this.disableFlip(),this.disablePan()):1<e?(this.disableFlip(),this.enablePan()):this.enableFlip(),this.options.main.onZoom(e)},enableAutoplay:function(e){},updateCurrentPage:function(e){},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},onSwipe:function(e,i,s,t,o,n,l){},onPageLoaded:function(e,i){var s=this.options.rightToLeft?this.options.numPages-e-1:e;this.pagesArr[s].onPageLoaded(i,this.options.pages[e].canvas[i],this.options.pages[e].htmlContent),this.updateTool()},onPageUnloaded:function(e,i){var s=this.options.rightToLeft?this.options.numPages-e-1:e;this.pagesArr[s].unload()},disableFlip:function(){this.flipEnabled=!1,this.iscroll.disable()},enableFlip:function(){this.flipEnabled=!0,this.iscroll.enable()},enablePan:function(){this.slides[0].iscroll&&this.slides[0].iscroll.enable(),this.slides[1].iscroll&&this.slides[1].iscroll.enable(),this.slides[2].iscroll&&this.slides[2].iscroll.enable()},disablePan:function(){this.slides[0].iscroll&&this.slides[0].iscroll.disable(),this.slides[1].iscroll&&this.slides[1].iscroll.disable(),this.slides[2].iscroll&&this.slides[2].iscroll.disable()}},FLIPBOOK.PageSwipe=function(e,i,s,t){this.index=i,this.options=e,this.texture=s,this.html=t,this.index=i,this.$wrapper=jQuery("<div>").addClass("flipbook-carousel-page"),this.wrapper=this.$wrapper[0],this.$inner=jQuery("<div>").appendTo(this.$wrapper).addClass("flipbook-carousel-page-inner"),this.$img=jQuery("<img>"),e.pagePreloader?this.$preloader=jQuery('<img src="'+e.pagePreloader+'" class="flipbook-page-preloader-image">').appendTo(this.$inner):this.$preloader=jQuery('<img src="'+e.assets.spinner+'" class="flipbook-page-preloader">').appendTo(this.$inner);var o=e.pageTextureSize,n=o*e.pageWidth/e.pageHeight;this.setSize(n,o)},FLIPBOOK.PageSwipe.prototype={load:function(t){if(this.loaded)t&&t.call(this);else{this.loaded=!0;var e=this.options.rightToLeft?this.options.numPages-this.index-1:this.index;if(this.options.pdfMode)this.pageSize!=this.options.pageTextureSize?this.options.main.loadPage(e,this.options.pageTextureSize,t):t&&t.call(this);else{var o=this;this.options.main.loadPage(e,this.options.pageTextureSize,function(e){var i=document.createElement("img");i.src=e.image.src,o.$img=jQuery(i).addClass("page-carousel-img");e.image.naturalHeight;var s=e.image.naturalHeight;o.options.pageWidth,o.options.pageHeight;o.$img.appendTo(o.$inner),o.options.doublePage&&0<o.index&&o.index%2==0&&o.$img.css("left","-100%"),o.options.doublePage?0==o.index||o.index==o.options.pages.length-1&&!o.options.oddPages?o.$img.css("width","100%"):o.$img.css("width","200%"):o.$img.css("width","100%"),e.htmlContent&&(o.htmlContent=e.htmlContent[0],e.htmlContent.appendTo(o.$inner),o.updateHtmlContentSize()),t&&t.call(o)})}}},unload:function(){this.loaded=!1,this.pageSize=0,this.$preloader.appendTo(this.$inner)},onPageLoaded:function(e,i,s){if(this.pageSize!=e){this.pageSize=e;this.$inner.empty(),jQuery(i).appendTo(this.$inner),jQuery(s).appendTo(this.$inner),this.htmlContent=s,this.updateHtmlContentSize()}},dispose:function(){this.pageSize&&(this.pageSize=null,this.$inner.empty())},setSize:function(e,i){this.width=e,this.height=i,this.$wrapper.width(e).height(i),this.updateHtmlContentSize()},updateHtmlContentSize:function(){var e=this.height/1e3;this.htmlContent&&this.htmlContent.style&&(this.htmlContent.style.transform="scale("+e+") translateZ(0)",this.options.doublePage&&(this.index%2==0&&0<this.index?this.htmlContent.style.left="-100%":this.htmlContent.style.left="0"))}};